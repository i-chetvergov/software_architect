# Software Architect — Архитектурная документация (MkDocs + GitHub Pages)

Репозиторий содержит архитектурную документацию выпускного проекта по курсу «Архитектор программного обеспечения». Документация оформлена в формате архитектурного кейса и публикуется через **MkDocs** на **GitHub Pages**.

Тема проекта: **Платформа унифицированных коммуникаций (Unified Communications, UC)**.  
Цель: разработать и документировать **микросервисную архитектуру UC‑платформы** (проблема, контекст, требования, решения, диаграммы, ADR/ADL).

---

## Содержание документации

Документация организована по структуре курсовой работы:

- Описание проблемы
- Контекст
- Бизнес‑цели
- Архитектурные драйверы
- Ограничения (технологические и бизнесовые)
- Требования
- Пользовательские сценарии
- Сценарии атрибутов качества
- Описание решения
- Диаграммы (C4 Context, C4 Containers, Deployment, Sequence)
- Лог архитектурных решений (ADR/ADL)

---

## Структура репозитория

Основные каталоги и файлы:

```text
docs/                         # исходники документации MkDocs (Markdown)
  01_problem/                 # описание проблемы
  02_context/                 # контекст
  03_business_goals/          # бизнес‑цели
  04_arch_drivers/            # архитектурные драйверы
  05_constraints/             # ограничения
  06_requirements/            # требования
  07_use_cases/               # пользовательские сценарии
  08_quality_scenarios/       # сценарии атрибутов качества
  09_solution/                # описание решения
  10_diagrams/                # страницы диаграмм
  adr/                        # Architecture Decision Records (ADR)
  adl/                        # Architecture Description Language (ADL) / соглашения
  assets/diagrams/            # SVG‑диаграммы, отображаемые в MkDocs

mkdocs.yml                    # конфигурация MkDocs (nav, тема, плагины)
requirements.txt              # зависимости Python для сборки документации
```

---

## Требования к окружению

- **Python 3.10+** (рекомендуется Python 3.11)
- `pip`
- Рекомендуется использовать **virtualenv (venv)** для изоляции зависимостей

---

## Установка и запуск (локально)

Перейдите в корень репозитория и создайте виртуальное окружение:

```bash
python3 -m venv .venv
source .venv/bin/activate
```

Обновите `pip`:

```bash
python -m pip install --upgrade pip
```

Установите зависимости проекта:

```bash
pip install -r requirements.txt
```

Запустите dev‑сервер MkDocs:

```bash
mkdocs serve
```

Сайт будет доступен по адресу:

```text
http://127.0.0.1:8000/
```

> Dev‑сервер автоматически пересобирает сайт при изменении файлов в `docs/`.

---

## Проверка сборки (как в CI / GitHub Pages)

Обычная сборка:

```bash
mkdocs build --clean
```

Строгая сборка (рекомендуется, аналогично CI):

```bash
mkdocs build --clean --strict
```

> В режиме `--strict` любые предупреждения (например, некорректные ссылки или отсутствие файлов, указанных в `nav`) считаются ошибкой и останавливают сборку.

---

## Диаграммы (PlantUML → SVG)

В проекте используется подход «исходник диаграммы + публикуемый артефакт»:

- `.puml` — исходники диаграмм (редактирование/воспроизводимость)
- `.svg` — отрендеренные диаграммы для отображения на страницах MkDocs

### Требования к размещению SVG

Чтобы диаграммы корректно публиковались в GitHub Pages, **SVG‑файлы должны лежать внутри `docs/`** (MkDocs копирует в итоговый сайт только содержимое каталога `docs/`).

Рекомендуемое размещение:

```text
docs/assets/diagrams/
```

### Экспорт диаграмм (PlantUML → SVG)

Для автоматического экспорта всех диаграмм из `_puml/` в SVG используется скрипт `export_diagrams.sh`.

**Требования:**
- Установленный **PlantUML** (установка: `brew install plantuml`)

**Запуск скрипта:**

Перейдите в корень проекта и выполните:

```bash
./export_diagrams.sh
```

Или с указанием полного пути к скрипту:

```bash
cd /path/to/project
./export_diagrams.sh
```

Скрипт выполняет следующие действия:

1. Проверяет наличие PlantUML
2. Удаляет все существующие SVG файлы из `docs/assets/diagrams/`
3. Экспортирует все `.puml` файлы из `_puml/` в SVG
4. Сохраняет SVG файлы в `docs/assets/diagrams/`
5. Выводит отчёт о количестве обработанных файлов

**Обрабатываемые файлы:**
- `uc-01.puml` ... `uc-09.puml` (Use Cases)
- `c4_context.puml` (C4 Context)
- `c4_containers.puml` (C4 Containers)
- `deployment.puml` (Deployment)
- `sequences.puml` (Sequence)

После выполнения скрипта все SVG файлы обновляются в соответствии с текущими `.puml` исходниками.

### Ссылки на диаграммы в Markdown

В страницах `docs/10_diagrams/*.md` используются относительные ссылки, например:

```md
![C4 Context](../assets/diagrams/C4_Context_UC_Platform.svg)
```

---

## Публикация в GitHub Pages

Публикация выполняется через **GitHub Actions**.

1. Workflow запускается при `push` в основную ветку (обычно `main`).
2. Устанавливаются зависимости из `requirements.txt`.
3. Выполняется сборка сайта (`mkdocs build`, часто с `--strict`).
4. Результат публикуется в GitHub Pages.

В настройках репозитория:

```text
Settings → Pages → Source: GitHub Actions
```

---

## Частые проблемы

### Локально работает, а GitHub Pages нет

Проверьте:

1. Все изображения/диаграммы (SVG) находятся **внутри `docs/`**.
2. `mkdocs build --clean --strict` проходит локально без ошибок.
3. В GitHub Actions установлены зависимости: `pip install -r requirements.txt`.
4. В `mkdocs.yml` в `nav` нет ссылок на несуществующие файлы.

---

## Быстрая памятка команд

**Установка и запуск:**
```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
mkdocs serve
mkdocs build --clean --strict
```

**Экспорт диаграмм (PlantUML → SVG):**
```bash
./export_diagrams.sh
```
