# Архитектурные драйверы

**Проект:** Корпоративная платформа унифицированных коммуникаций (**Unified Communications, UC**)

---

## Введение

Архитектурные драйверы фиксируют ключевые факторы, которые определяют архитектуру UC-платформы и ограничивают пространство проектных решений.  
Драйверы выводятся из ранее зафиксированных артефактов проекта:

- **Описание проблемы** — причины и последствия фрагментации коммуникаций, рост TCO, отсутствие интеграций, риски ИБ и недоступности;
- **Контекст системы** — стейкхолдеры, внешние интеграции, границы системы как архитектурный контракт;
- **Бизнес-цели и KPI** — консолидация 5–7 решений в 1 платформу, снижение TCO 30–40%, ускорение интеграций, SLA 99,9% и т.д.;
- **Ограничения** и **требования** (FR/NFR) — функциональные и нефункциональные ожидания к платформе.

Драйверы используются как вход для:
- выбора архитектурных паттернов и технологий (раздел «Архитектурное решение»);
- фиксации решений в **ADR**;
- проектирования и проверки через **Quality Attribute Scenarios** и целевые метрики.

---

## Список архитектурных драйверов

Ниже приведён согласованный набор архитектурных драйверов (AD-01…AD-07).  
Формулировки сделаны так, чтобы **не конфликтовать** с разделами «Контекст» и «Бизнес-цели»:  
в контексте мы фиксируем *потребности и окружение*, в драйверах — *что именно «двигает» архитектуру* и *какие решения неизбежно возникают*.

---

### AD-01. Масштабируемость и эластичность под нагрузкой

**Смысл для архитектуры:** платформа должна выдерживать рост числа пользователей и активных коммуникаций без «перестройки фундамента», обеспечивая предсказуемую работу в пиках и возможность наращивать мощности выборочно.

**Происхождение (трассировка):**
- из **проблемы**: ограничения монолитных телеком-решений и высокий риск простоев при пиках;
- из **контекста**: распределённая/гибридная инфраструктура, разные типы клиентов;
- из **бизнес-целей/KPI**: рост аудитории/нагрузки без пропорционального роста затрат.

**Архитектурные требования (ожидаемый эффект):**
- горизонтальное масштабирование сервисов по доменам (messaging/presence/call control и т.д.);
- предсказуемые задержки при пиковых нагрузках (рабочие часы, массовые события);
- автоматическое масштабирование по метрикам нагрузки.

**Архитектурные следствия (типовые решения):**
- микросервисная декомпозиция с независимым масштабированием;
- stateless-подход в прикладных сервисах + внешнее хранение состояния;
- Kubernetes HPA/автоскейлинг, кэширование (например, Redis) и очереди/стриминг для разгрузки OLTP.

**Связь с диаграммами:** C4 Containers, Deployment  
**Связь с ADR:** ADR по декомпозиции и масштабированию (будет привязан в разделе ADR)

---

### AD-02. Высокая доступность и отказоустойчивость (Business-Critical Communications)

**Смысл для архитектуры:** коммуникации являются бизнес-критичными; отказ отдельных компонентов/узлов/зон не должен приводить к потере ключевых сервисов и длительным простоям.

**Происхождение (трассировка):**
- из **проблемы**: недопустимость простоев и сложность восстановления в разрозненной инфраструктуре;
- из **контекста**: эксплуатация + ИБ требуют управляемости и быстрых восстановлений;
- из **KPI**: целевой SLA (например, ≥ 99,9%), требования по MTTR/времени восстановления.

**Архитектурные требования (ожидаемый эффект):**
- отказ узла/инстанса не влияет на доступность сервисов (no single point of failure на уровне приложения);
- multi-zone развёртывание для критичных сервисов (где применимо);
- управляемая деградация: частичный отказ не «роняет» платформу целиком.

**Архитектурные следствия (типовые решения):**
- N+1 репликация stateless-компонентов;
- HA для хранилищ и очередей (репликация/кворумные схемы, резервное переключение);
- self-healing в Kubernetes, healthchecks, readiness/liveness, controlled failover;
- изоляция real-time контуров (сигнализация/медиа) от «медленных» интеграций.

**Связь с диаграммами:** C4 Containers, Deployment  
**Связь с ADR:** ADR по HA/DR и real-time контурам

---

### AD-03. Безопасность коммуникаций и данных (Security & Compliance by Design)

**Смысл для архитектуры:** единая платформа должна обеспечить единые политики IAM, защиту трафика и данных, аудит и соответствие регуляторным требованиям (GDPR и аналоги), включая чувствительные данные (CDR, записи, логи, метаданные коммуникаций).

**Происхождение (трассировка):**
- из **проблемы**: неоднородная безопасность, риски утечек, отсутствие единого аудита;
- из **контекста**: внешние IdP/LDAP, SIEM, требования ИБ к централизации;
- из **бизнес-целей**: управляемость и соответствие требованиям.

**Архитектурные требования (ожидаемый эффект):**
- единая модель аутентификации/авторизации (RBAC/ABAC, SSO, MFA);
- шифрование трафика на внешних границах и внутри платформы;
- защищённые real-time коммуникации (WebRTC DTLS-SRTP / SRTP, безопасный SIP-периметр);
- централизованный аудит действий и событий безопасности.

**Архитектурные следствия (типовые решения):**
- IAM/Identity Service + интеграция с корпоративными IdP (OIDC/SAML), policy enforcement;
- API Gateway как enforcement point (authn/authz/rate limit/версионирование);
- mTLS для межсервисной коммуникации, секреты/PKI-управление;
- защищённый SIP Edge (роль SBC) как security boundary для SIP/PSTN;
- централизованный аудит и интеграция с SIEM.

**Связь с диаграммами:** C4 Context, C4 Containers, Sequence (SSO/IAM)  
**Связь с ADR:** ADR по security boundary и IAM/policy

---

### AD-04. Интегрируемость и открытость (Enterprise Integrations)

**Смысл для архитектуры:** UC-платформа должна быть интегрируемой “по умолчанию”: с CRM/ERP/Service Desk/Issue Tracker и внешними каналами, при минимизации vendor lock-in и с возможностью независимого развития интеграций.

**Происхождение (трассировка):**
- из **проблемы**: отсутствие глубокой интеграции → ручной ввод, потеря контекста;
- из **контекста**: наличие множества внешних систем и интеграторов;
- из **бизнес-целей**: сокращение времени интеграции «с месяцев до недель».

**Архитектурные требования (ожидаемый эффект):**
- стандартизированные внешние API (REST), внутренние контракты (gRPC) при необходимости;
- поддержка webhooks и событийной модели для сквозных сценариев;
- документирование контрактов и версионирование интерфейсов.

**Архитектурные следствия (типовые решения):**
- API Gateway как единая точка входа внешних интеграций;
- событийная шина (Kafka/RabbitMQ) + доменные события для асинхронных сценариев;
- контрактная дисциплина (schema registry/версии), идемпотентность обработчиков;
- отдельный integration-контур/плагины без влияния на real-time критический путь.

**Связь с диаграммами:** C4 Context, C4 Containers  
**Связь с ADR:** ADR по интеграционному контуру и event-driven

---

### AD-05. Наблюдаемость и управляемость (Observability & Operations)

**Смысл для архитектуры:** платформа должна быть диагностируемой и управляемой: метрики, логи, трассировка, аудит, алертинг и корреляция событий — как часть продукта, а не “после внедрения”.

**Происхождение (трассировка):**
- из **проблемы**: сложность эксплуатации множества систем, рост точек отказа;
- из **контекста**: потребности эксплуатации/ИБ, внешние APM/SIEM/NMS;
- из **бизнес-целей**: снижение операционных затрат и ускорение реакции на инциденты.

**Архитектурные требования (ожидаемый эффект):**
- единые стандарты телеметрии (метрики/логи/трейсы), trace-корреляция;
- быстрый поиск причин инцидентов и подтверждение соблюдения SLA/SLO;
- интеграция с корпоративными платформами наблюдаемости и безопасности.

**Архитектурные следствия (типовые решения):**
- OpenTelemetry как стандарт инструментирования;
- observability stack (Prometheus/Grafana + логи + трассировка) или интеграция в корпоративный стек;
- единые идентификаторы корреляции (trace-id, call-id/session-id/message-id);
- отдельные SLO для real-time контуров (вызовы/медиа) и data-контуров (история/аналитика).

**Связь с диаграммами:** Deployment  
**Связь с ADR:** ADR по observability/telemetry

---

### AD-06. Сопровождаемость и скорость изменений (Evolvability)

**Смысл для архитектуры:** UC-платформа должна развиваться без «каскадных» изменений и длительных простоев; отдельные домены должны обновляться независимо, с контролируемым риском релизов.

**Происхождение (трассировка):**
- из **проблемы**: сложность модернизации монолитных/разрозненных решений;
- из **контекста**: много интеграций и разные типы клиентов/протоколов;
- из **бизнес-целей**: ускорение вывода функций и интеграций.

**Архитектурные требования (ожидаемый эффект):**
- независимые релизы доменов и стабильные контракты;
- минимизация каскадных изменений;
- CI/CD и управляемые стратегии доставки (blue-green/canary) для ключевых сервисов.

**Архитектурные следствия (типовые решения):**
- доменная декомпозиция (DDD bounded contexts) и контрактный подход;
- версионирование API/событий, backward compatibility;
- event-driven взаимодействия там, где синхронность не требуется критически;
- тестовые контуры для интеграций, контрактное тестирование.

**Связь с диаграммами:** C4 Containers  
**Связь с ADR:** ADR по декомпозиции/контрактам/CI-CD

---

### AD-07. Оптимизация стоимости владения (TCO) и консолидация

**Смысл для архитектуры:** архитектура должна вести к консолидации функций и снижению затрат — не только инфраструктурных, но и операционных (эксплуатация, обновления, безопасность, сопровождение).

**Происхождение (трассировка):**
- из **проблемы**: рост TCO из-за множества решений и дублирования функций;
- из **контекста**: поэтапная консолидация без остановки бизнеса;
- из **бизнес-целей/KPI**: снижение TCO на 30–40%, уменьшение числа систем.

**Архитектурные требования (ожидаемый эффект):**
- отказ от дублирующих подсистем и единые политики управления;
- рациональное использование ресурсов через масштабирование и унификацию инфраструктуры;
- снижение сложности сопровождения и количества “точек владения”.

**Архитектурные следствия (типовые решения):**
- консолидация коммуникационных доменов в единую платформу с единым периметром;
- стандартизация протоколов/интеграций, уменьшение vendor lock-in;
- контейнеризация и унификация эксплуатационных практик;
- изоляция доменов при сохранении единого UX (чтобы консолидация не стала монолитом).

**Связь с диаграммами:** C4 Context, Deployment  
**Связь с ADR:** ADR по консолидации и технологическим стандартам

---

## Трассировка драйверов к решениям

Ниже приведена таблица трассировки, которая используется как “карта связей”
между драйверами, архитектурным решением, ADR и диаграммами.

> Примечание: идентификаторы ADR указаны как целевые ссылки.  
> Финальные номера ADR синхронизируем после фиксации списка ADR.

| Драйвер | Что определяет в архитектуре | Раздел «Архитектурное решение» | ADR | Диаграммы |
|---|---|---|---|---|
| AD-01 | масштабирование сервисов и контуров | Декомпозиция/скейлинг/кэширование | ADR: Decomposition, Scaling | C4 Containers, Deployment |
| AD-02 | HA/DR, self-healing, деградация | HA/DR + критические контуры | ADR: HA/DR, Real-time isolation | C4 Containers, Deployment |
| AD-03 | IAM, периметр, шифрование, аудит | Security boundary + IAM | ADR: IAM/Policy, SIP Edge/SBC | C4 Context, C4 Containers, Sequence |
| AD-04 | API/Events, интеграции | Integration plane | ADR: API strategy, Event-driven | C4 Context, C4 Containers |
| AD-05 | метрики/логи/трейсы, SLO | Observability | ADR: Telemetry | Deployment |
| AD-06 | независимые релизы, контракты | Evolvability | ADR: Contracts, Versioning, CI/CD | C4 Containers |
| AD-07 | консолидация и стандартизация | TCO | ADR: Consolidation standards | C4 Context, Deployment |

---

## Приоритизация драйверов

Приоритизация используется для планирования архитектурной проработки и выбора глубины детализации в диаграммах, ADR и сценариях атрибутов качества.

| Драйвер | Критичность для бизнеса | Техническая сложность | Приоритет |
|---|---:|---:|---|
| AD-02 (HA) | Критично | Высокая | P0 |
| AD-03 (Security) | Критично | Высокая | P0 |
| AD-01 (Scalability) | Высокая | Средняя | P1 |
| AD-04 (Integrations) | Высокая | Средняя | P1 |
| AD-05 (Observability) | Средняя | Средняя | P2 |
| AD-06 (Evolvability) | Средняя | Средняя | P2 |
| AD-07 (TCO) | Средняя | Низкая–средняя | P3 |

---

## Связь с последующими разделами

Архитектурные драйверы используются как входные данные для следующих артефактов проекта:

- **Ограничения** — уточнение факторов, которые ограничивают достижение драйверов и определяют компромиссы;
- **Требования** — детализация FR/NFR и сценариев атрибутов качества, подтверждающих достижение драйверов;
- **Архитектурное решение** — обоснование выбранной декомпозиции, контуров и принципов построения платформы;
- **ADR** — фиксация ключевых решений, принятых для удовлетворения драйверов, включая анализ альтернатив и последствий.

Трассируемость “проблема → цели → драйверы → решения → ADR → диаграммы”
является обязательным принципом оформления архитектурной документации проекта.