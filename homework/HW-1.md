#  "Мир веб-крафта" - Браузерный MMORPG шутер

## **Бизнес-контекст**

Развлекательная компания выходит на рынок браузерных игр с высококачественным MMOFPS, доступным напрямую через браузер.

**Ключевые аспекты**

- **Низкий порог входа:** без установки клиента.
- **Технологический экспорт:** успешные компоненты выделяются в B2B-решения.
- **UGC-экономика:** платформа пользовательского контента с модерацией и монетизацией.
- **Кроссплатформенность:** современные десктоп/мобайл браузеры.
---
## Бизнес-цели и драйверы

| Цель                                   | KPI и метрики                                                                           |
| -------------------------------------- | --------------------------------------------------------------------------------------- |
| **Рост пользовательской базы**         | 1M+ регистраций в первый год<br>500k+ MAU<br>D30 Retention > 25%                        |
| **Монетизация**                        | ARPPU > $20<br>Конверсия в покупку > 5%<br>5% выручки от UGC маркетплейса               |
| **Создание технологической платформы** | 3+ выделенных сервиса для лицензирования<br>PoC для демонстрации инвесторам             |
| **Операционная эффективность**         | 99.9% доступности<br>Автоматическое масштабирование<br>Быстрое восстановление при сбоях |
## Стейкхолдеры и потребности

### Основные группы стейкхолдеров:

**Игроки:**
- Честный матчмейкинг и анти-чит
- Низкая задержка - (RTT P95 ≤ 80–120 мс, авто-подбор региона)
- Стабильный FPS и качественная графика
- Безопасные платежи
- Локальный чат “Социальное взаимодействие"

**Создатели контента (UGC):**
- Редакторы карт/правил/оружия
- Прозрачная модерация и версионирование
- Опции монетизации и фидбек от игроков

**Операционная команда:**
- Инструменты наблюдения и мониторинга
- Быстрое развертывание обновлений
- A/B тестирование функциональности
- Управление инцидентами

**Бизнес-стейкхолдеры:**
- Аналитика и отчетность
- Инструменты промо-кампаний
- Управление турнирами
- Compliance (GDPR, платежи)

## Пользовательские истории

### Эпик: Игровой процесс

US-001: Матчмейкинг
Как игрок, я хочу быстро найти матч с соперниками моего уровня
Критерии приемки:
- Поиск ≤ 10 сек при 200k CCU
- Разница ELO ≤ 100 пунктов
• Автовыбор региона по пингу

US-002: Локальный чат
Как игрок, я хочу общаться с игроками в зоне слышимости
Критерии приемки:
- Голосовой чат через WebRTC
- Настраиваемый радиус общения
- Фильтрация контента и модерация

**US-005 Зритель**
Как гость, хочу наблюдать, оставаясь невидимым/не влияя на матч.
Критерии приемки:
- read-only state; задержка 5–15 с (анти-ghosting); отдельные лимиты пропускной.
### Эпик: Монетизация

US-003: Покупки в игре
Как игрок, я хочу покупать снаряжение без перезапуска игры
Критерии приемки:
- Процесс оплаты ≤ 3 клика
- Поддержка 3-D Secure
- Мгновенное получение предмета

### Эпик: Социальные функции **UGC**

US-004: Приватные турниры
Как организатор, я хочу создавать турниры по приглашениям
Критерии приемки:
- Приватные ссылки-приглашения
- Настройка формата и правил
- Экспорт результатов

## Атрибуты качества (NFR)

### Производительность и масштабируемость

- **Клиент:** Холодный старт < 4 сек, FPS ≥ 60
- **Сеть:** RTT ≤ 80ms (P95), тикрейт 30-60 Hz
- **Масштабируемость:** Поддержка 1M+ CCU
### Надежность

- **Доступность:** 99.9% uptime
- **Восстановление:** ≤ 10 сек при падении матч-сервера
- **Сохранность данных:** Резервное копирование игровых сессий
### Безопасность

- **Server-authoritative architecture**
- **PCI DSS compliance** для платежей
- **Защита от DDoS** и читерства
### Совместимость

- **Браузеры:** Последние 2 версии Chrome, Firefox, Safari, Edge
- **Графика:** WebGL 2.0 + WebGPU progressive enhancement
- **Аудио:** WebRTC для голосового чата
## Критические сценарии

### Сценарий 1: Пиковый нагрузочный тест

**Цель:** Обеспечение стабильности при 100k одновременных поисков матча  
**Критические параметры:**

- Время отклика матчмейкинга ≤ 10 сек
- Распределение по регионам без перекосо
- Graceful degradation при перегрузке
### Сценарий 2: Платежный шторм

**Цель:** Обработка 20k RPS во время рекламной акции  
**Критические параметры:**

- Идемпотентность платежных операций
- Согласованность данных инвентаря
- Надежность интеграции с PSP
### Сценарий 3: Турнир с призами

**Цель:** Проведение турнира на 256 участников со зрителями  
**Критические параметры:**

- Защита от ghosting (задержка 5-15 сек)
- Честность проведения матчей
- Целостность результатов
## Архитектурные решения (ADR)

### ADR-001: Сервер-авторитетная архитектура

## Status
Accepted
## Context
Требуется обеспечить честность геймплея и защиту от читерства в competitive PvP игре. Клиентская часть работает в ненадежной среде браузера.

## Decision
Вся игровая логика (физика, попадания, применение способностей) выполняется и валидируется на игровых серверах. Клиенты отправляют только input data.

## Consequences
**Positive:**
- Высокий уровень защиты от читов
- Консистентность игрового состояния
- Централизованное управление логикой

**Negative:**
- Высокие требования к серверной инфраструктуре
- Зависимость от качества сети
- Сложность реализации prediction/reconciliation

### ADR-002: Web-based клиент с WASM

## Status
Accepted

## Context
Требование кроссплатформенности и мгновенного доступа через браузер при сохранении AAA-качества графики и производительности.

## Decision
Использование WebAssembly для игровой логики, WebGL 2.0/WebGPU для рендеринга, WebTransport для сетевого взаимодействия.

## Consequences
**Positive:**
- Кроссплатформенность из коробки
- Высокая производительность, близкая к нативной
- Быстрые итерации разработки

**Negative:**
- Сложность отладки WASM
- Зависимость от возможностей браузера
- Большой размер initial bundle

## **Контекстная диаграмма**

Диаграмма предоставляется отдельным файлом (C4-Context). Взаимосвязи: Web-клиент Auth/Matchmaking/Game Servers/Proximity Chat/Store/UGC/CDN/Observability; внешние: PSP, анти-чит сигналы, стрим-платформы.
